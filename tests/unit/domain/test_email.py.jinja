"""Unit tests for Email value object."""

from result import Err, Ok

from {{ project_slug }}.domain.value_objects.email import Email


def test_email_creation_success() -> None:
    """Test successful email creation."""
    result = Email.try_create("user@example.com")
    assert result == Ok(Email(value="user@example.com"))


def test_email_creation_lowercase() -> None:
    """Test email is converted to lowercase."""
    result = Email.try_create("User@Example.COM")
    assert result == Ok(Email(value="user@example.com"))


def test_email_empty_string() -> None:
    """Test email creation fails with empty string."""
    result = Email.try_create("")
    assert result == Err("Email cannot be empty")


def test_email_missing_at_symbol() -> None:
    """Test email creation fails without @ symbol."""
    result = Email.try_create("userexample.com")
    assert result == Err("Email must contain @ symbol")


def test_email_multiple_at_symbols() -> None:
    """Test email creation fails with multiple @ symbols."""
    result = Email.try_create("user@@example.com")
    assert result == Err("Email must contain exactly one @ symbol")


def test_email_empty_local_part() -> None:
    """Test email creation fails with empty local part."""
    result = Email.try_create("@example.com")
    assert result == Err("Email local part cannot be empty")


def test_email_empty_domain_part() -> None:
    """Test email creation fails with empty domain part."""
    result = Email.try_create("user@")
    assert result == Err("Email domain part cannot be empty")


def test_email_domain_without_dot() -> None:
    """Test email creation fails when domain has no dot."""
    result = Email.try_create("user@example")
    assert result == Err("Email domain must contain at least one dot")


def test_email_string_representation() -> None:
    """Test email string representation."""
    result = Email.try_create("user@example.com")
    match result:
        case Ok(email):
            assert str(email) == "user@example.com"
        case Err(_):
            assert False, "Email creation should succeed"
